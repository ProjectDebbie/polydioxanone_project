library(tidyr)
library(tidytext)
library(dplyr)
library(pluralize)
library(ggplot2)

# in the dataframe, create and one column containing the titles and abstracts of each record
pdo$text <- paste(pdo$Title, pdo$Abstracts)

# tokenize, remove stop words
t <- df %>% group_by(PMID) %>% unnest_tokens(word, text) %>% anti_join(stop_words) %>% ungroup()

# remove words shorter than 3 characters
t <- subset(t, nchar(as.character(word)) >= 3)

#singularize all words and count them by year
t$word <- singularize(t$word)
df <- t %>% group_by(Year) %>% count(word, sort = TRUE)

